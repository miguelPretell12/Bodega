function clean(){$("#id").val(""),$("#nombre").val(""),$("#direccion").val(""),$("#empresa").val("")}function tableAll(){$("#table_id").DataTable({destroy:!0,ajax:{method:"GET",url:"/dashboard/sedes/getSedes"},columns:[{data:"sede"},{data:"empresa"},{data:"direccion"},{data:"supervisornombre"},{data:null,render:function(e,a,t){return`\n            <button class="btn btn-warning far fa-edit" data-idsede="${e.id}" id="edit" data-bs-toggle="modal" data-bs-target="#modalSede" ></button>\n            <button class="btn btn-danger far fa-trash-alt" data-idsede="${e.id}" id="delete"></button>\n          `}}]})}function formulario(){$(document).on("submit","#formulario",(function(e){e.preventDefault();const a=$("#id").val(),t=$("#nombre").val(),o=$("#direccion").val(),n=$("#empresa").val(),r=$("#supervisor").val(),d=new FormData;d.append("nombre",t.toLowerCase()),d.append("direccion",o.toLowerCase()),d.append("empresa",n.toLowerCase()),d.append("idSupervisor",r),""==t||""==o||""==n||""==r?Swal.fire({position:"top-end",icon:"error",title:"Completar los campos requeridos",showConfirmButton:!1,timer:1500}):""==a?create(d):(d.append("id",a),update(d))}))}function obtenerData(){$(document).on("click","#edit",(function(e){const a=e.target.dataset.idsede,t=new FormData;t.append("id",a),getSede(t)}))}function eliminarSede(){$(document).on("click","#delete",(function(e){const a=e.target.dataset.idsede,t=new FormData;Swal.fire({title:"Â¿ Usted quiere eliminar este usuario ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, deseo eliminar el usuario"}).then(e=>{e.isConfirmed&&(t.append("id",a),remove(t))})}))}async function create(e){const a=await fetch(" /dashboard/sedes/create",{method:"POST",body:e}),t=await a.json(),{res:o,mensaje:n}=t;o?Swal.fire("Error!",n,"error"):(Swal.fire("Exito!",n,"success"),$("#modalSede").modal("hide"),tableAll())}async function update(e){const a=await fetch(" /dashboard/sedes/update",{method:"POST",body:e}),t=await a.json(),{resp:o}=t;o&&(Swal.fire("Exito!","Se edito correctamente la sede","success"),$("#modalSede").modal("hide"),tableAll())}async function getSede(e){const a=await fetch(" /dashboard/sedes/getSede",{method:"POST",body:e}),t=await a.json(),{data:o}=t;$("#id").val(o.id),$("#nombre").val(o.nombre),$("#direccion").val(o.direccion),$("#empresa").val(o.empresa)}async function remove(e){const a=await fetch(" /dashboard/sedes/delete",{method:"POST",body:e}),t=await a.json(),{resp:o}=t;o?(Swal.fire("Exito!","Se elimino de manera efectiva la sede","success"),tableAll()):Swal.fire("Error!","Error al eliminar la sede, puede que ya ha sido registrado en otros registros","error")}async function getSupervisor(){const e=await fetch("/dashboard/sedes/getSupervisor"),a=await e.json(),{data:t}=a,o=document.querySelector("#supervisor");t.forEach(e=>{const a=document.createElement("option"),{id:t,nombre:n,dni:r,correo:d,cargo:i,estado:s}=e;"A"==s&&(a.value=t,a.innerHTML=""+n,o.appendChild(a))}),console.log(t)}$(document).ready((function(){tableAll(),formulario(),obtenerData(),eliminarSede(),getSupervisor()})),$(document).on("click","#btn",(function(){clean()}));