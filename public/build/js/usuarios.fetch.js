async function create(a){const o=await fetch("http://localhost:4000/dashboard/usuarios/create",{method:"POST",body:a}),e=await o.json(),{res:t,mensaje:r}=e;t?Swal.fire("Error!",r,"error"):(Swal.fire("Exito",r,"success"),tableAll())}async function update(a){const o=await fetch("http://localhost:4000/dashboard/usuarios/update",{method:"POST",body:a}),e=await o.json(),{res:t}=e;t?(Swal.fire("Exito","Se edito correctamente el usuario","success"),tableAll()):Swal.fire("Error!","Hubo un error al editar el usuario","error")}async function remove(a){const o=await fetch("http://localhost:4000/dashboard/usuarios/delete",{method:"POST",body:a}),e=await o.json(),{res:t}=e;t?Swal.fire("Eliminado!","El Usuario ha sido eliminado correctamente","success"):Swal.fire("Error!","El usuario no ha sido eliminado correctamente","error")}async function getUsuario(a){const o=await fetch("http://localhost:4000/dashboard/usuarios/getUsuario",{method:"POST",body:a}),e=await o.json(),{id:t,nombre:r,apellido:n,dni:i,correo:s,password:d,idCargo:l,estado:c}=e.data;console.log(e),$("#id").val(t),$("#nombre").val(r),$("#apellido").val(n),$("#dni").val(i),$("#correo").val(s),$("#password").val(d),$("#cargo").val(l),$("#estado").val(c)}async function getCargos(){const a=await fetch("http://localhost:4000/dashboard/cargos/lists"),o=await a.json(),{data:e}=o,t=document.querySelector("#cargo");e.forEach(a=>{const o=document.createElement("option");o.textContent=a.nombre,o.value=a.id,t.appendChild(o)}),console.log(e)}async function getSedes(){const a=await fetch("http://localhost:4000/dashboard/sedes/getSedes"),o=await a.json(),e=document.querySelector("#sede"),{data:t}=o;t.forEach(a=>{const o=document.createElement("option");o.value=a.id,o.textContent=` ${a.nombre} - ${a.empresa}`,e.appendChild(o)})}async function getUsuarios(){const a=await fetch("http://localhost:4000/dashboard/usuarios/getUsuarios"),o=await a.json(),e=document.querySelector("#supervisor"),{data:t}=o;t.forEach(a=>{const{cargo:o,nombre:t,id:r,estado:n}=a,i=document.createElement("option");"supervisor"!=o.trim()&&"administrador"!=o||"A"!=n||(i.value=r,i.textContent=t,e.appendChild(i))}),console.log(o)}function tableAll(){$("#table_id").DataTable({destroy:!0,ajax:{method:"GET",url:"/dashboard/usuarios/getUsuarios"},columns:[{data:"nombre"},{data:"correo"},{data:"dni"},{data:"cargo"},{data:"estado"},{data:null,render:function(a,o,e){return`\n            <button class="btn btn-warning far fa-edit" data-idusuario="${a.id}" id="edit" data-bs-toggle="modal" data-bs-target="#modalUsuario" ></button>\n          <button class="btn btn-danger far fa-trash-alt" data-idusuario="${a.id}" id="delete"></button>\n                  `}}]})}function formulario(){$(document).on("submit","#formulario",(function(a){a.preventDefault();const o=$("#id").val(),e=$("#nombre").val(),t=$("#apellido").val(),r=$("#dni").val(),n=$("#correo").val(),i=$("#password").val(),s=$("#cargo").val(),d=$("#estado").val(),l=$("#sede").val(),c=$("#supervisor").val(),u=new FormData;u.append("nombre",e),u.append("apellido",t),u.append("dni",r),u.append("correo",n),u.append("password",i),u.append("idCargo",s),u.append("estado",d),u.append("idSupervisor",c),u.append("idSede",l),""==e||""==t||""==r||""==n||""==i||""==s||""==d?Swal.fire({position:"top-end",icon:"error",title:"Completar los campos requeridos",showConfirmButton:!1,timer:1500}):""==o?create(u):(u.append("id",o),update(u))}))}function obtenerData(){$(document).on("click","#edit",(function(a){clean();const o=a.target.dataset.idusuario;$("#title").text("Editar Usuario");const e=new FormData;e.append("id",o),getUsuario(e)}))}function clean(){$("#id").val(""),$("#nombre").val(""),$("#apellido").val(""),$("#dni").val(""),$("#correo").val(""),$("#password").val(""),$("#cargo").val(""),$("#estado").val("")}function deleteUsuario(){$(document).on("click","#delete",(function(a){const o=a.target.dataset.idusuario,e=new FormData;e.append("id",o),Swal.fire({title:"Â¿ Usted quiere eliminar este usuario ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, deseo eliminar el usuario"}).then(a=>{a.isConfirmed&&(remove(e),tableAll())})}))}$(document).ready((function(){tableAll(),getCargos(),formulario(),obtenerData(),deleteUsuario(),getSedes(),getUsuarios()})),$(document).on("click","#btn-register",(function(a){clean(),$("#title").text("Registrar Usuario")})),$(document).on("click","#password",(function(a){a.target.value=""}));