async function create(a){const e=await fetch(" /dashboard/usuarios/create",{method:"POST",body:a}),o=await e.json(),{res:t,mensaje:r}=o;t?Swal.fire("Error!",r,"error"):(Swal.fire("Exito",r,"success"),tableAll())}async function update(a){const e=await fetch(" /dashboard/usuarios/update",{method:"POST",body:a}),o=await e.json(),{res:t}=o;t?(Swal.fire("Exito","Se edito correctamente el usuario","success"),tableAll()):Swal.fire("Error!","Hubo un error al editar el usuario","error")}async function remove(a){const e=await fetch(" /dashboard/usuarios/delete",{method:"POST",body:a}),o=await e.json(),{res:t}=o;t?Swal.fire("Eliminado!","El Usuario ha sido eliminado correctamente","success"):Swal.fire("Error!","El usuario no ha sido eliminado correctamente","error")}async function getUsuario(a){const e=await fetch(" /dashboard/usuarios/getUsuario",{method:"POST",body:a}),o=await e.json(),{id:t,nombre:r,apellido:n,dni:i,correo:s,password:d,idCargo:l,estado:c}=o.data;console.log(o),$("#id").val(t),$("#nombre").val(r),$("#apellido").val(n),$("#dni").val(i),$("#correo").val(s),$("#password").val(d),$("#cargo").val(l),$("#estado").val(c)}async function getCargos(){const a=await fetch(" /dashboard/cargos/lists"),e=await a.json(),{data:o}=e,t=document.querySelector("#cargo");o.forEach(a=>{const e=document.createElement("option");e.textContent=a.nombre,e.value=a.id,t.appendChild(e)}),console.log(o)}async function getSedes(){const a=await fetch(" /dashboard/sedes/getSedes"),e=await a.json(),o=document.querySelector("#sede"),{data:t}=e;t.forEach(a=>{const e=document.createElement("option");e.value=a.id,e.textContent=` ${a.nombre} - ${a.empresa}`,o.appendChild(e)})}async function getUsuarios(){const a=await fetch(" /dashboard/usuarios/getUsuarios"),e=await a.json(),o=document.querySelector("#supervisor"),{data:t}=e;t.forEach(a=>{const{cargo:e,nombre:t,id:r,estado:n}=a,i=document.createElement("option");"supervisor"!=e.trim()&&"administrador"!=e||"A"!=n||(i.value=r,i.textContent=t,o.appendChild(i))}),console.log(e)}function tableAll(){$("#table_id").DataTable({destroy:!0,ajax:{method:"GET",url:"/dashboard/usuarios/getUsuarios"},columns:[{data:"nombre"},{data:"correo"},{data:"dni"},{data:"cargo"},{data:"estado"},{data:null,render:function(a,e,o){return`\n            <button class="btn btn-warning far fa-edit" data-idusuario="${a.id}" id="edit" data-bs-toggle="modal" data-bs-target="#modalUsuario" ></button>\n          <button class="btn btn-danger far fa-trash-alt" data-idusuario="${a.id}" id="delete"></button>\n                  `}}]})}function formulario(){$(document).on("submit","#formulario",(function(a){a.preventDefault();const e=$("#id").val(),o=$("#nombre").val(),t=$("#apellido").val(),r=$("#dni").val(),n=$("#correo").val(),i=$("#password").val(),s=$("#cargo").val(),d=$("#estado").val(),l=$("#supervisor").val(),c=new FormData;c.append("nombre",o),c.append("apellido",t),c.append("dni",r),c.append("correo",n),c.append("password",i),c.append("idCargo",s),c.append("estado",d),c.append("idSupervisor",l),""==o||""==t||""==r||""==n||""==i||""==s||""==d?Swal.fire({position:"top-end",icon:"error",title:"Completar los campos requeridos",showConfirmButton:!1,timer:1500}):""==e?create(c):(c.append("id",e),update(c))}))}function obtenerData(){$(document).on("click","#edit",(function(a){clean();const e=a.target.dataset.idusuario;document.querySelector("#password").parentElement.style.display="none",$("#title").text("Editar Usuario");const o=new FormData;o.append("id",e),getUsuario(o)}))}function clean(){$("#id").val(""),$("#nombre").val(""),$("#apellido").val(""),$("#dni").val(""),$("#correo").val(""),$("#password").val(""),$("#cargo").val(""),$("#estado").val("")}function deleteUsuario(){$(document).on("click","#delete",(function(a){const e=a.target.dataset.idusuario,o=new FormData;o.append("id",e),Swal.fire({title:"Â¿ Usted quiere eliminar este usuario ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, deseo eliminar el usuario"}).then(a=>{a.isConfirmed&&(remove(o),tableAll())})}))}$(document).ready((function(){tableAll(),getCargos(),formulario(),obtenerData(),deleteUsuario(),getUsuarios()})),$(document).on("click","#btn-register",(function(a){clean(),$("#title").text("Registrar Usuario")})),$(document).on("click","#password",(function(a){a.target.value=""}));