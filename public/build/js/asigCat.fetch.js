function tableAll(){$("#table_id").DataTable({destroy:!0,ajax:{method:"GET",url:"/dashboard/asignarCategoria/getAsignarCats"},columns:[{data:null,render:function(e,a,t){return`\n            ${e.sede} (${e.empresa})\n          `}},{data:"direccion"},{data:"categoria"},{data:null,render:function(e,a,t){return`<button class="btn btn-${"H"==e.estado?"success":"danger"} fas fa-${"H"==e.estado?"check":"times"}-circle"\n          id="status" data-idasig = "${e.id}" data-estado = "${e.estado}"\n            >\n            <i></i>\n            </button>`}}]})}function formulario(){$(document).on("submit","#formulario",(function(e){e.preventDefault();const a=$("#sede").val(),t=$("#categoria").val(),s=$("#estado").val(),n=new FormData;n.append("idSede",a),n.append("idCategoria",t),n.append("estado",s),create(n)}))}function updateStatus(){$(document).on("click","#status",(function(e){const a=e.target.dataset.idasig,t=e.target.dataset.estado,s=new FormData;s.append("id",a),s.append("estado",t),updateEstado(s,e)}))}async function create(e){spinnerHide("flex");const a=await fetch(" /dashboard/asignarCategoria/create",{method:"POST",body:e});a&&spinnerHide("none");const t=await a.json(),{res:s,mensaje:n}=t;s?Swal.fire("Error!",n,"error"):Swal.fire("Exito!",n,"success")}async function updateEstado(e,a){a.target.classList.remove("fa-times-circle","fa-check-circle"),a.target.classList.add("fa-spinner","fa-spin");const t=await fetch(" /dashboard/asignarCategoria/updateStatus",{method:"POST",body:e});t&&a.target.classList.remove("fa-spinner","fa-spin");const s=await t.json(),{res:n,estado:o}=s;n?"H"==o?(a.target.classList.remove("btn-danger","fa-times-circle"),a.target.classList.add("btn-success","fa-check-circle"),a.target.dataset.estado="H"):(a.target.classList.remove("btn-success","fa-check-circle"),a.target.classList.add("btn-danger","fa-times-circle"),a.target.dataset.estado="I"):Swal.fire("Error!","Hubo un error al cambiar el estado","error")}async function getCategorias(){const e=await fetch(" /dashboard/categorias/getCategorias"),a=await e.json(),{data:t}=a,s=document.querySelector("#categoria");t.forEach(e=>{const{id:a,nombre:t}=e,n=document.createElement("option");n.value=a,n.textContent=t,s.appendChild(n)})}async function getSedes(){const e=await fetch(" /dashboard/sedes/getSedes"),a=await e.json(),{data:t}=a,s=document.querySelector("#sede");t.forEach(e=>{const{id:a,sede:t,empresa:n}=e,o=document.createElement("option");o.value=a,o.textContent=`${t} (${n})`,s.appendChild(o)})}function spinnerHide(e){document.querySelector("#spinner").style.display=e}$(document).ready((function(e){tableAll(),getCategorias(),getSedes(),formulario(),updateStatus()}));